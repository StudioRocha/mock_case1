(function() {
    'use strict';
    
    // ============================================
    // ブラウザバック対応：ページをリロードして未読数を更新
    // ============================================
    // ブラウザバックでキャッシュから復元された場合、サーバー側の処理が実行されないため、
    // 最新の未読メッセージ数が反映されません。
    // そのため、キャッシュから復元された場合はページをリロードして、
    // サーバー側で最新の未読数を計算し直します。
    
    // ページ表示時（通常の読み込みとブラウザバックの両方）に処理
    window.addEventListener('pageshow', function(event) {
        // ブラウザバックでキャッシュから復元された場合、ページをリロード
        // これにより、サーバー側で最新の未読メッセージ数が計算される
        if (event.persisted) {
            // キャッシュから復元された場合のみリロード
            window.location.reload();
        }
    });
})();
